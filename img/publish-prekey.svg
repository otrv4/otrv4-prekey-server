<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1682" height="802" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[participant Alice
participant Server

Note over Alice, Server: Alice has long-term keypairs (I, g*I) and the Server has (R, g*R)

Note over Alice: Generates previously user profile (A)

Note over Server: Generates previously a server profile (S)

Note over Alice, Server: DAKE

Alice->Server: (A, g*i).

Server->Server: t = “0” ∥ KDF(0x02 ∥ A) ∥ KDF(0x03 ∥ S) ∥ g*i ∥ g*r ∥ KDF(0x04 ∥ phi)
Server->Server: sig = RSig(g*R, R, {g*I, g*R, g*i}, t)
Server->Server: k = KDF(0x01 ∥ (g*i)*r)
Server->Alice: (S, g*r, sig)

Alice->Alice: k = KDF(0x01 ∥ (g*r)*i)
Alice->Alice: t = "1" ∥ KDF(0x05 ∥ A) ∥ KDF(0x06 ∥ S) ∥ g*i ∥ g*r ∥ KDF(0x07 ∥ phi)
Alice->Alice: sig = RSig(g*I, I, {g*I, g*R, g*r}, t)
Alice->Alice: MAC = KDF(0x08 ∥ prekey messages)
Alice->Server: (sig, 0x01 ∥ N ∥ prekey messages ∥ MAC)

Server->Server: Store prekeys

Server->Alice: OK
]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="165" y="20" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="175" y="45" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="175">Alice</tspan></text></g><g class="actor"><rect x="165" y="743" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="175" y="768" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="175">Alice</tspan></text></g><line x1="200" x2="200" y1="59" y2="743" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="866" y="20" width="80" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="876" y="45" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="876">Server</tspan></text></g><g class="actor"><rect x="866" y="743" width="80" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="876" y="768" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="876">Server</tspan></text></g><line x1="906" x2="906" y1="59" y2="743" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="note"><rect x="190" y="79" width="726" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="195" y="99" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="195">Alice has long-term keypairs (I, g*I) and the Server has (R, g*R)</tspan></text></g><g class="note"><rect x="10" y="128" width="380" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="15" y="148" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="15">Generates previously user profile (A)</tspan></text></g><g class="note"><rect x="696" y="177" width="420" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="701" y="197" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="701">Generates previously a server profile (S)</tspan></text></g><g class="note"><rect x="190" y="226" width="726" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="195" y="246" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="195">DAKE</tspan></text></g><g class="signal"><text x="508" y="285.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="508">(A, g*i).</tspan></text><line x1="200" x2="906" y1="294" y2="294" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="931" y="328.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="931">t = “0” ∥ KDF(0x02 ∥ A) ∥ KDF(0x03 ∥ S) ∥ g*i ∥ g*r ∥ KDF(0x04 ∥ phi)</tspan></text><line x1="906" x2="926" y1="314" y2="314" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="926" y1="314" y2="338" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="906" y1="338" y2="338" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="931" y="367.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="931">sig = RSig(g*R, R, {g*I, g*R, g*i}, t)</tspan></text><line x1="906" x2="926" y1="353" y2="353" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="926" y1="353" y2="377" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="906" y1="377" y2="377" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="931" y="406.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="931">k = KDF(0x01 ∥ (g*i)*r)</tspan></text><line x1="906" x2="926" y1="392" y2="392" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="926" y1="392" y2="416" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="906" y1="416" y2="416" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="488" y="441.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="488">(S, g*r, sig)</tspan></text><line x1="906" x2="200" y1="450" y2="450" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="225" y="484.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="225">k = KDF(0x01 ∥ (g*r)*i)</tspan></text><line x1="200" x2="220" y1="470" y2="470" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="220" y1="470" y2="494" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="200" y1="494" y2="494" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="225" y="523.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="225">t = "1" ∥ KDF(0x05 ∥ A) ∥ KDF(0x06 ∥ S) ∥ g*i ∥ g*r ∥ KDF(0x07 ∥ phi)</tspan></text><line x1="200" x2="220" y1="509" y2="509" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="220" y1="509" y2="533" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="200" y1="533" y2="533" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="225" y="562.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="225">sig = RSig(g*I, I, {g*I, g*R, g*r}, t)</tspan></text><line x1="200" x2="220" y1="548" y2="548" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="220" y1="548" y2="572" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="200" y1="572" y2="572" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="225" y="601.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="225">MAC = KDF(0x08 ∥ prekey messages)</tspan></text><line x1="200" x2="220" y1="587" y2="587" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="220" y1="587" y2="611" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="220" x2="200" y1="611" y2="611" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="362.5" y="636.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="362.5">(sig, 0x01 ∥ N ∥ prekey messages ∥ MAC)</tspan></text><line x1="200" x2="906" y1="645" y2="645" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="931" y="679.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="931">Store prekeys</tspan></text><line x1="906" x2="926" y1="665" y2="665" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="926" y1="665" y2="689" style="stroke-width: 2;" stroke="#000000" fill="none"></line><line x1="926" x2="906" y1="689" y2="689" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="543" y="714.5" style="font-size: 16px; font-family: Andale\ Mono, monospace;"><tspan x="543">OK</tspan></text><line x1="906" x2="200" y1="723" y2="723" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>