<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="966" height="494" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[participant Alice
participant Server
participant Bob

Bob->Bob: Generate prekey message
Bob->Bob: Generate ephemeral our_ecdh
Bob->Bob: Generate ephemeral our_dh

Bob->Server: Authenticate using DAKE
Bob->Server: Publish prekey message
Server->Server: Validate Bob's user profile

Alice->Server: Retrieve Bob's prekey message]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><path d="M10,20C43.8,22.4 54.0,17.6 69.0,20.0C70.6,34.2 67.4,40.1 69.0,60.0C40.7,57.6 43.5,62.4 10.0,60.0C8.4,38.5 11.6,43.3 10.0,20.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="20" y="47" style="font-size: 16px; font-family: danielbd;"><tspan x="20">Alice</tspan></text></g><g class="actor"><path d="M10,434C48.4,436.4 54.8,431.6 69.0,434.0C67.4,457.8 70.6,448.8 69.0,474.0C24.2,476.4 34.3,471.6 10.0,474.0C8.4,453.1 11.6,443.0 10.0,434.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="20" y="461" style="font-size: 16px; font-family: danielbd;"><tspan x="20">Alice</tspan></text></g><path d="M39.5,60.0C54.5,149.8 24.5,265.6 39.5,434.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><g class="actor"><path d="M284.5,20C303.2,16.9 307.1,23.1 362.5,20.0C364.1,50.4 360.9,53.6 362.5,60.0C341.6,63.1 315.3,56.9 284.5,60.0C282.9,29.6 286.1,32.5 284.5,20.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="295.5" y="45" style="font-size: 16px; font-family: danielbd;"><tspan x="294.5">Server</tspan></text></g><g class="actor"><path d="M284.5,434C307.8,437.1 343.8,430.9 362.5,434.0C360.9,463.6 364.1,445.9 362.5,474.0C341.4,477.1 303.2,470.9 284.5,474.0C286.1,444.0 282.9,443.2 284.5,434.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="295.5" y="459" style="font-size: 16px; font-family: danielbd;"><tspan x="294.5">Server</tspan></text></g><path d="M323.5,60.0C338.5,194.9 308.5,154.2 323.5,434.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><g class="actor"><path d="M567.5,20C596.8,17.8 610.1,22.2 623.5,20.0C625.1,50.4 621.9,44.4 623.5,60.0C599.8,57.8 604.4,62.2 567.5,60.0C565.9,46.9 569.1,44.7 567.5,20.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="577.5" y="46" style="font-size: 16px; font-family: danielbd;"><tspan x="577.5">Bob</tspan></text></g><g class="actor"><path d="M567.5,434C605.1,431.8 576.5,436.2 623.5,434.0C625.1,443.6 621.9,452.9 623.5,474.0C605.6,471.8 580.9,476.2 567.5,474.0C569.1,440.4 565.9,467.6 567.5,434.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="577.5" y="460" style="font-size: 16px; font-family: danielbd;"><tspan x="577.5">Bob</tspan></text></g><path d="M595.5,60.0C580.5,121.2 610.5,374.2 595.5,434.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><g class="signal"><text x="620.5" y="100" style="font-size: 16px; font-family: danielbd;"><tspan x="620.5">Generate prekey message</tspan></text><path d="M595.5,80.0C608.4,80.8 602.6,79.2 615.5,80.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M615.5,80.0C616.9,94.4 614.1,89.7 615.5,115.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M615.5,115.0C600.3,115.8 610.7,114.2 595.5,115.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="620.5" y="150" style="font-size: 16px; font-family: danielbd;"><tspan x="620.5">Generate ephemeral our_ecdh</tspan></text><path d="M595.5,130.0C612.3,130.8 606.3,129.2 615.5,130.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M615.5,130.0C614.1,159.4 616.9,156.6 615.5,165.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M615.5,165.0C601.2,164.2 612.3,165.8 595.5,165.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="620.5" y="200" style="font-size: 16px; font-family: danielbd;"><tspan x="620.5">Generate ephemeral our_dh</tspan></text><path d="M595.5,180.0C609.9,180.8 603.6,179.2 615.5,180.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M615.5,180.0C614.1,189.7 616.9,195.0 615.5,215.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M615.5,215.0C612.3,214.2 604.2,215.8 595.5,215.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="348" y="236" style="font-size: 16px; font-family: danielbd;"><tspan x="348">Authenticate using DAKE</tspan></text><path d="M595.5,262.0C367.0,272.9 411.9,251.1 323.5,262.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="360" y="288" style="font-size: 16px; font-family: danielbd;"><tspan x="360">Publish prekey message</tspan></text><path d="M595.5,314.0C477.5,324.9 416.2,303.1 323.5,314.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="348.5" y="354" style="font-size: 16px; font-family: danielbd;"><tspan x="348.5">Validate Bob's user profile</tspan></text><path d="M323.5,334.0C327.5,333.2 330.7,334.8 343.5,334.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M343.5,334.0C344.9,353.9 342.1,349.4 343.5,369.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M343.5,369.0C326.7,369.8 332.4,368.2 323.5,369.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="49.5" y="389" style="font-size: 16px; font-family: danielbd;"><tspan x="49.5">Retrieve Bob's prekey message</tspan></text><path d="M39.5,414.0C84.9,402.6 183.7,425.4 323.5,414.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g></svg>