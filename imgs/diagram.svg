<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="919" height="444" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[participant Alice
participant Server
participant Bob

Bob->Bob: Generate prekey message
Bob->Bob: Generate ephemeral our_ecdh
Bob->Bob: Generate ephemeral our_dh

Bob->Sever: Authenticate using DAKE
Bob->Server: Publish prekey message

Alice->Server: Retrieve Bob's prekey message]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><path d="M10,20C41.5,22.4 36.2,17.6 69.0,20.0C67.4,50.4 70.6,53.6 69.0,60.0C19.4,57.6 35.1,62.4 10.0,60.0C11.6,26.4 8.4,46.0 10.0,20.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="20" y="47" style="font-size: 16px; font-family: danielbd;"><tspan x="20">Alice</tspan></text></g><g class="actor"><path d="M10,384C24.2,381.6 54.8,386.4 69.0,384.0C70.6,399.0 67.4,398.2 69.0,424.0C54.8,426.4 48.2,421.6 10.0,424.0C8.4,417.6 11.6,412.0 10.0,384.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="20" y="411" style="font-size: 16px; font-family: danielbd;"><tspan x="20">Alice</tspan></text></g><path d="M39.5,60.0C52.5,238.1 26.5,137.8 39.5,384.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><g class="actor"><path d="M284.5,20C326.3,23.1 343.5,16.9 362.5,20.0C360.9,41.7 364.1,26.4 362.5,60.0C323.2,56.9 329.1,63.1 284.5,60.0C286.1,53.6 282.9,42.8 284.5,20.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="295.5" y="45" style="font-size: 16px; font-family: danielbd;"><tspan x="294.5">Server</tspan></text></g><g class="actor"><path d="M284.5,384C303.2,387.1 339.7,380.9 362.5,384.0C364.1,407.8 360.9,393.6 362.5,424.0C303.2,420.9 313.5,427.1 284.5,424.0C286.1,397.1 282.9,390.4 284.5,384.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="295.5" y="409" style="font-size: 16px; font-family: danielbd;"><tspan x="294.5">Server</tspan></text></g><path d="M323.5,60.0C336.5,238.1 310.5,231.5 323.5,384.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><g class="actor"><path d="M514.5,20C555.5,22.2 542.5,17.8 570.5,20.0C572.1,47.6 568.9,29.8 570.5,60.0C561.5,57.8 557.1,62.2 514.5,60.0C516.1,33.1 512.9,46.4 514.5,20.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="524.5" y="46" style="font-size: 16px; font-family: danielbd;"><tspan x="524.5">Bob</tspan></text></g><g class="actor"><path d="M514.5,384C537.9,381.8 539.1,386.2 570.5,384.0C568.9,408.8 572.1,393.6 570.5,424.0C530.7,426.2 557.1,421.8 514.5,424.0C512.9,416.1 516.1,399.1 514.5,384.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="524.5" y="410" style="font-size: 16px; font-family: danielbd;"><tspan x="524.5">Bob</tspan></text></g><path d="M542.5,60.0C555.5,217.4 529.5,332.2 542.5,384.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><g class="actor"><path d="M821.5,20C878.6,17.3 873.2,22.7 889.5,20.0C887.9,26.4 891.1,36.2 889.5,60.0C878.6,57.3 873.2,62.7 821.5,60.0C819.9,26.4 823.1,50.4 821.5,20.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="832.5" y="45" style="font-size: 16px; font-family: danielbd;"><tspan x="831.5">Sever</tspan></text></g><g class="actor"><path d="M821.5,384C832.4,381.3 866.1,386.7 889.5,384.0C887.9,395.9 891.1,390.4 889.5,424.0C837.9,426.7 849.1,421.3 821.5,424.0C823.1,417.0 819.9,414.4 821.5,384.0" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></path><text x="832.5" y="409" style="font-size: 16px; font-family: danielbd;"><tspan x="831.5">Sever</tspan></text></g><path d="M855.5,60.0C842.5,322.1 868.5,284.1 855.5,384.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><g class="signal"><text x="567.5" y="100" style="font-size: 16px; font-family: danielbd;"><tspan x="567.5">Generate prekey message</tspan></text><path d="M542.5,80.0C550.6,79.2 545.7,80.8 562.5,80.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M562.5,80.0C561.1,85.6 563.9,100.8 562.5,115.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M562.5,115.0C545.7,114.2 552.7,115.8 542.5,115.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="567.5" y="150" style="font-size: 16px; font-family: danielbd;"><tspan x="567.5">Generate ephemeral our_ecdh</tspan></text><path d="M542.5,130.0C547.3,129.2 552.8,130.8 562.5,130.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M562.5,130.0C561.1,141.1 563.9,155.1 562.5,165.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M562.5,165.0C548.8,164.2 557.7,165.8 542.5,165.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="567.5" y="200" style="font-size: 16px; font-family: danielbd;"><tspan x="567.5">Generate ephemeral our_dh</tspan></text><path d="M542.5,180.0C545.7,180.8 551.3,179.2 562.5,180.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M562.5,180.0C563.9,206.6 561.1,188.4 562.5,215.0" style="stroke-width: 2;" stroke="#000000" fill="none"></path><path d="M562.5,215.0C555.6,214.2 551.4,215.8 542.5,215.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="587.5" y="236" style="font-size: 16px; font-family: danielbd;"><tspan x="587.5">Authenticate using DAKE</tspan></text><path d="M542.5,262.0C768.4,249.5 617.6,274.5 855.5,262.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="333.5" y="288" style="font-size: 16px; font-family: danielbd;"><tspan x="333.5">Publish prekey message</tspan></text><path d="M542.5,314.0C358.5,305.2 492.4,322.8 323.5,314.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g><g class="signal"><text x="49.5" y="339" style="font-size: 16px; font-family: danielbd;"><tspan x="49.5">Retrieve Bob's prekey message</tspan></text><path d="M39.5,364.0C107.7,352.6 245.4,375.4 323.5,364.0" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></path></g></svg>